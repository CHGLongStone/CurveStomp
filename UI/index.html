<!doctype html>
<html lang="en" dir="ltr">
<head>

	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
	<meta charset="utf-8">
	<meta name="google" value="notranslate">
	<meta name="referrer" content="strict-origin">

	<link  rel="stylesheet"  type="text/css" href="assets/css/bootstrap.min.css"  />
	<link  rel="stylesheet"  type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css"  />
	<link  rel="stylesheet"  type="text/css" href="assets/css/bootstrap-responsive.min.css"  />
	<link rel="stylesheet" href="assets/css/curvestomp.css"></link>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
	   integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
	   crossorigin=""/>
	
	<!-- 
	<link rel="localization" hreflang="en" href="assets/js/l10n/en.json" type="application/l10n+json" >
	-->
	
	
	<title>DRAFT: CurveStomp COVID-19 Self-Reporting Questionnaire</title>
</head>
<body>
	<h1 id="in_page_title">DRAFT: COVID-19 Self-Reporting Questionnaire</h1>
  
	<div id="content_main" class="col-sm-12" >
		
		<div id="action_buttons" class="col-sm-12 register_form" >

			<div class="row " >
				<div class="question" id="">
					Is this your first time reporting? <input type="checkbox" class="question" id="first_time" name="first_time">
				</div>
				<br>
			</div>
			
		</div>
		<div class="section row" id="returning" style="display: block;">
			<div class="row " >
				<h2>Submit Another Report</h2>
				<div class="row " >
					<div id="" class="col-sm-2 question" >
						Identity
					</div>
					<div id="" class="col-sm-4 " >
						<input type="text" class="question" id="user_guid" name="user_guid" value="">
					</div>
				</div>
				<div class="row " >
					<div id="" class="col-sm-2 question" >
						Passcode
					</div>
					<div id="" class="col-sm-4 " >
						<input type="password" class="question" id="passcode" name="passcode" value="">
					</div>
				</div>
				<div class="row " >
					<div id="" class="col-sm-2 question" >
					</div>
					<div id="" class="col-sm-4 " >
						<button 
							type="button" 
							name="report_resource" 
							class="btn "  
							onclick="CurveStomp.login();"
						>Login</button>
					</div>
				</div>
			</div>
		</div>
		<div class="section row" id="identity" style="display: none;">
			<div class="row " >
				<h2 data-i18n="appname-intentity-profile-title">Identity Profile</h2>
				<!-- GOTO 'location' -->
				<p>The following questions will be used to create your profile, so that <br>
					you may login in for subsequent reports track your situation as the <br>
					<br>
					To ensure anonimity you may create a hashed User Identity <br>
					instead of using an email address.<br>
					the hashed "User Identity" will be stored as a cookie,<br>
					you will not be required to login again as long as <br>
					* your cookie exists <br>
					* and has not expired.<br>
					<br>
					Please Record your "User Identity" and your passcode<br>
				</p>
			</div>
			<div class="row " >
			
				<div id="" class="col-sm-2 question" >
					Email *(optional)
				</div>
				<div id="" class="col-sm-4 " >
					<input type="text" class="" id="email" name="email" value="">
				</div>
			</div>
			<div class="row " >
				<div id="" class="col-sm-2 question" >
					User Identity
				</div>
				<div id="" class="col-sm-7 " >
					<input type="text" class=" col-sm-12" id="user_identity" name="user_identity" value="">
				</div>
			</div>
			<div class="row " >
				<div id="" class="col-sm-2 question" >
					Passcode
				</div>
				<div id="" class="col-sm-4 " >
					<input type="password" class="" id="pwd_input" name="pwd_input" value="">
				</div>
			</div>
			<div class="row " >
				<div id="" class="col-sm-2 question" >
					Confirm
				</div>
				<div id="" class="col-sm-4 " >
					<input type="password" class="" id="pwd_input_confirm" name="pwd_input_confirm" value="">
				</div>
			</div>
			
			<div class="row " >
				<div class="section" id="household">
					<div class="row " >
						<h3>Household Profile</h3>
						<p>Please assign each member of your household a unique number, incrementing from 1, and
							make note of each member's number. These numbers will be used in subsequent reports to
							track the symptom progression of each household member.
						</p>
					</div>
					<div class="row " >
						<div id="" class="col-sm-3 question" >
							Household Members:
						</div>
						<div id="" class="col-sm-2 " >
							<input type="text" class=" int_field" width="1"  name="household_size" value="0">
						</div>
						<div id="" class="col-sm-6 " >
							<div class="question " id="household_size"></div>
						</div>
					</div>
					<div class="row " >
						<p>Please provide basic stats for each household member, to assist researchers
							in statistical analysis.
						</p>
					</div>
					<div class="row " id="household_members" >

					</div>
				</div>
			</div>

			<div class="button" id="identity_submit">
				<button type="button" name="net" class="btn " onclick="CurveStomp.validateIdentityProfile();">Next (Location Profile)</button>
				<!-- 
				Submit Registration
				<button type="button" name="net" class="btn " onclick="next('location_profile')">Next</button>
				
				
				-->
			</div>
			
			
			
		</div>
		<div class="section row" id="location" style="display: none;">
			<div class="row " >
				<h2>Location Profile</h2>
			</div>
			<div class="row " >
				<p>The following questions will collect anonymous, regional information <br>
				about your profile. This information will be used to associate reports <br>
				to geographical areas for analysis, and should not be personally identifiable.<br>
				</p>
				<p>Household ID is a unique hash value to distinguish different households <br>
				within your area, you may:<br>
				* enter a name of your choosing<br>
				* use the automatically generated hash <br>
				</p>
				<p> Location data will only be generated with your consent. <br>
					If you consent to using location data you will be able to choose.<br>  
					The map interface will allow you to control the degree of accuracy.<br>
				</p>
			</div>
			<div class="row " >
				<div id="" class="col-sm-2 " >
					Country
				</div>
				<div id="country_container" class="col-sm-2 " >
					<input type="text" class="" id="country" name="country" value="">
					<input type="hidden" class="" id="country_iso" name="country_iso" value="">
				</div>
			</div>
			<div class="row " >
				<div id="" class="col-sm-2 " >
					Region
				</div>
				<div id="" class="col-sm-2 " >
					<input type="text" class="" id="region" name="region" value="">
				</div>
			</div>
			<div class="row " >
				<div id="" class="col-sm-2 " >
					City
				</div>
				<div id="" class="col-sm-2 " >
					<input type="text" class="" id="city" name="city" value="">
				</div>
			</div>
			<div class="row " >
				<div id="" class="col-sm-2 " >
					Street
				</div>
				<div id="" class="col-sm-2 " >
					<input type="text" class="" id="street" name="street" value="">
				</div>
			</div>
			<div class="row " >
				<div id="" class="col-sm-2 " >
					postal code
				</div>
				<div id="" class="col-sm-2 " >
					<input type="text" class="" id="postal_code" name="postal_code" value="">
				</div>
			</div>
			<div class="row " >
				<div id="" class="col-sm-2 " >
					Household ID
				</div>
				<div id="" class="col-sm-6 " >
					<input type="text" class="col-sm-12" id="household_guid" name="household_guid" width="36" value="">
				</div>
				<div id="" class="col-sm-1 " >
					&nbsp;
				</div>
				
				
			</div>
			<div class="row " >	
				<div id="" class="col-sm-2 " >
						<button 
							type="button" 
							name="get_map" 
							class="btn "  
							onclick="CurveStomp.validateGeoRequest();"
						>Include Location Data</button>
				</div>				
			</div>

			
			<div id="mapid" style="display: none;" ></div>
			<div id="map_bucket" style="display: none;" ></div>


			<div class="row " >
				<div id="" class="col-sm-12 " >
					<!-- 
					<button type="submit" name="Submit" class="btn ">Submit Registration</button>
					-->
					<button type="button" name="register" class="btn " onclick="CurveStomp.registration.user()">Submit Registration</button>
				</div>
			</div>
		</div>
		
		
		
		<div id="report_list" class="col-sm-12 register_form" style="display:none;" >
			<div class="row " >
				<h2>Report List</h2>
			</div>
			<div class="row " >
				<div id="" class="col-sm-4 " >
					<button 
						type="button" 
						name="report_symptom_status" 
						class="btn "  
						onclick="pageSingle('symptom_form'), 
						CurveStomp.reports.renderReport('symptom');"
					>Report Symptom Status</button>
				</div>
				<div id="" class="col-sm-4 " >
					<button 
						type="button" 
						name="report_resource" 
						class="btn "  
						onclick="CurveStomp.reports.renderTestingReport();"
					>Report Testing Status</button>
				</div>
				<div id="" class="col-sm-4 " >
					<button 
						type="button" 
						name="report_resource" 
						class="btn "  
						onclick="CurveStomp.reports.renderReport('transmission');"
					>Report Transmission Profile</button>
				</div>
			</div>
		</div>
		
		
		
		<div id="symptom_form" class="col-sm-12 register_form" style="display:none;" >
			<div class="row " >
				<h2>Symptom Report</h2>
			</div>
			<div class="row " >
				<p>Please provide information on your symptoms below. If you are not experiencing symptoms, 
				please leave the scales at their default positions.
				</p>
			</div>
		</div>
		
		
		<div id="testing_form" class="col-sm-12 register_form" style="display:none;" >
			<div class="row " >
				<h2>Testing Report</h2>
			</div>
			<div class="row " >
				<p>If you've been undergone laboratory testing or other medical diagnosis 
				relating to COVID-19, please provide details:
				</p>
			
			</div>
		</div>
		
		<div id="transmission_form" class="col-sm-12 register_form" style="display:none;" >
			<div class="row " >
				<h2>Transmission  Profile</h2>
			</div>
			<div class="row " >
				<p>The following questions will assist in regional containment and mitigation, and in determining the level of 
				self-isolation practiced within a region. Please answer these questions carefully and honestly.
				</p>
			</div>
		
		</div>
		
		<div id="resource_status_form" class="col-sm-12 register_form" style="display:none;" >
			resource_status_form
		
		</div>
		
		
	</div>
	
	
<div style="display: none;">
	<div template="country_select" country_select >
		<select name="country_select" id="country_select" class="select-css"  title="country" onchange="setCountry();">
			<option value="" selected >-- Select Country --</option>
		</select>
	</div>

	

	<div template="household_member" household_member >
				<div class="row member_row" >
					<div id="" class="col-sm-1 question household_member_stats" household-member_id>
						
					</div>
					<div id="" class="col-sm-1 question household_member_stats" >
						<input type="hidden" class="" id="" name="member_id" value="" household-member_id>
						Age
					</div>
					<div id="" class="col-sm-2 " >
						
						<input type="text" class=" household_member_stats int_field" id="" name="member_age" value="">
					</div>
					<div id="" class="col-sm-2 question household_member_stats" >
						Gender
					</div>
					<div id="" class="col-sm-6 " >
						<select name="gender_select" id="" class="select-css"  title="country"  >
							<option value="2"  >-- Unspecified --</option>
							<option value="0"  >Female</option>
							<option value="1"  >Male</option>
						</select>
					</div>
				</div>
	</div>
	
	<div template="symptom_report_item" symptom_report_item >
					<div class="row " >
						<div style="display: none;" report_item-name></div>
						
						<div id="" class="col-sm-3 question" report_item-display_name >
							report_item-display_name
						</div>
						<div id="" class="col-sm-2 " report_item-min_label></div>
						<div id="" class="col-sm-4 " >
							<div class="question slider" name="symptom_level" report_item-symptom_level></div>
						</div>
						<div id="" class="col-sm-2 " report_item-max_label></div>
						<div id="" class="col-sm-1 " >
							<input type="text" class=" int_field" width="1"  name="report_item-name" value="" report_item-value>
						</div>
					</div>
	</div>
	<div template="testing_report" testing_report >
			<div class="row " >
				<div style="display: none;" report_item-name >tested</div>
				<div id="" class="col-sm-2 question" >
					Tested:
				</div>
				<div id="" class="col-sm-1 " >
					Negative
				</div>
				<div id="" class="col-sm-1 " >
					<input type="radio" class=" int_field" width="1"  name="tested" value="0">
				</div>
				<div id="" class="col-sm-2 " >
					&nbsp;
				</div>
				<div id="" class="col-sm-1 " >
					Positive
				</div>
				<div id="" class="col-sm-4 " >
					<input type="radio" class=" int_field" width="1"  name="tested" value="1">
				</div>
			</div>
			<div class="row " >
				<div style="display: none;" report_item-name >recovered</div>
				<div id="" class="col-sm-2 question" >
					Recovered:
				</div>
				<div id="" class="col-sm-1 " >
					No
				</div>
				<div id="" class="col-sm-1 " >
					<input type="radio" class=" int_field" width="1"  name="recovered" value="0">
				</div>
				<div id="" class="col-sm-2 " >
					&nbsp;
				</div>
				<div id="" class="col-sm-1 " >
					Yes
				</div>
				<div id="" class="col-sm-4 " >
					<input type="radio" class=" int_field" width="1"  name="recovered" value="1">
				</div>
			</div>
			<div class="row " >
				<div style="display: none;" report_item-name >hospitalized</div>
				<div id="" class="col-sm-2 question" >
					Hospitalized:
				</div>
				<div id="" class="col-sm-1 " >
					No
				</div>
				<div id="" class="col-sm-1 " >
					<input type="radio" class=" int_field" width="1"  name="hospitalized" value="0">
				</div>
				<div id="" class="col-sm-2 " >
					&nbsp;
				</div>
				<div id="" class="col-sm-1 " >
					Yes
				</div>
				<div id="" class="col-sm-4 " >
					<input type="radio" class=" int_field" width="1"  name="hospitalized" value="1">
				</div>
			</div>
			<div class="row " >
				<div style="display: none;" report_item-name >ventilation</div>
				<div id="" class="col-sm-2 question" >
					Mechanical Ventilation:
				</div>
				<div id="" class="col-sm-1 " >
					No
				</div>
				<div id="" class="col-sm-1 " >
					<input type="radio" class=" int_field" width="1"  name="ventilation" value="0">
				</div>
				<div id="" class="col-sm-2 " >
					&nbsp;
				</div>
				<div id="" class="col-sm-1 " >
					Yes
				</div>
				<div id="" class="col-sm-4 " >
					<input type="radio" class=" int_field" width="1"  name="ventilation" value="1">
				</div>
			</div>
			<div class="row " >
				<div style="display: none;" report_item-name >oxygen</div>
				<div id="" class="col-sm-2 question" >
					Oxygen Support:
				</div>
				<div id="" class="col-sm-1 " >
					Negative
				</div>
				<div id="" class="col-sm-1 " >
					<input type="radio" class=" int_field" width="1"  name="oxygen" value="0">
				</div>
				<div id="" class="col-sm-2 " >
					&nbsp;
				</div>
				<div id="" class="col-sm-1 " >
					Positive
				</div>
				<div id="" class="col-sm-4 " >
					<input type="radio" class=" int_field" width="1"  name="oxygen" value="1">
				</div>
			</div>
			<div class="row " >
				<p>If you had other symptoms not on the list above, please provide details to aid in the effort:
				</p>
			</div>
			<div class="row " >
				<div style="display: none;" report_item-name >other_symptoms</div>
				<div id="" class="col-sm-8 question" >
					<textarea name="other_symptoms" id="other_symptoms" class="form-control" rows="6"></textarea>
				</div>
			</div>
	</div>
	<div template="map_controls" map_controls >
			<div id="map_controls" style="display: block;">
				<div class="row " >
					<div id="coordinates" class="col-sm-12 " >
						Coordinates
					</div>				
				</div>
				<div class="row " >
					<div id="" class="" >
						<button 
							type="button" 
							name="report_symptom_status" 
							class="btn "  
							onclick="pageSingle('symptom_form'), 
							CurveStomp.setMapAccuracy('more');"
						>More Accurate</button>
						<button 
							type="button" 
							name="report_symptom_status" 
							class="btn "  
							onclick="pageSingle('symptom_form'), 
							CurveStomp.setMapAccuracy('less');"
						>Less Accurate</button>
					</div>
					<div id="" style="text-align: center;" >
						<button 
							type="button" 
							name="report_symptom_status" 
							class="btn "  
							onclick="pageSingle('symptom_form'), 
							CurveStomp.acceptSettings();"
						>Accept Settings</button>
					</div>
				</div>
				<div class="row " >
					<div id="" class="col-sm-3 " >
						Lattitude
					</div>
					<div id="" class="col-sm-2 " >
						<input type="text" class="" id="lattitude" name="lattitude" value="">
					</div>
				</div>
				<div class="row " >
					<div id="" class="col-sm-3 " >
						Longitude 
					</div>
					<div id="" class="col-sm-2 " >
						<input type="text" class="" id="longitude" name="longitude" value="">
					</div>
				</div>
			</div>
	</div>
</div>
<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>

<script src="assets/js/jquery_i18n/CLDRPluralRuleParser.js"></script>
<script src="assets/js/jquery_i18n/jquery.i18n.js"></script>
<script src="assets/js/jquery_i18n/jquery.i18n.messagestore.js"></script>
<script src="assets/js/jquery_i18n/jquery.i18n.fallbacks.js"></script>
<script src="assets/js/jquery_i18n/jquery.i18n.language.js"></script>
<script src="assets/js/jquery_i18n/jquery.i18n.parser.js"></script>
<script src="assets/js/jquery_i18n/jquery.i18n.emitter.js"></script>
<script src="assets/js/jquery_i18n/jquery.i18n.emitter.bidi.js"></script>




<script  type="text/javascript"    src="assets/js/CryptoJS/components/core.js" ></script>
<script  type="text/javascript"    src="assets/js/CryptoJS/components/x64-core.js" ></script>
<script  type="text/javascript"    src="assets/js/CryptoJS/components/lib-typedarrays.js" ></script>
<script  type="text/javascript"    src="assets/js/CryptoJS/components/md5.js" ></script>
<script  type="text/javascript"    src="assets/js/CryptoJS/components/sha3.js" ></script>
<script  type="text/javascript"    src="assets/js/CryptoJS/components/enc-base64.js" ></script>


<script  type="text/javascript"    src="assets/js/curvestomp.js" ></script>
<script  type="text/javascript"    src="assets/js/countries.js" ></script>

<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
   integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
   crossorigin=""></script>
   
<script  type="text/javascript" >
	if($( '#household_size' )){
		household_members = 1;
		
		$( "#household_size" ).slider({
			value: 1,
			min: 1,
			max: 9,
			slide: function( event, ui ) {
				$( "[name=household_size]" ).val(ui.value);
				household_members = ui.value;
				CurveStomp.registration.setMembers(household_members);
			},
			start: function( event, ui ) {
				var current = $('#household_members').find(".member_row").length;
				if(current >0){
					return;
				}
				$( "[name=household_size]" ).val(1);
				CurveStomp.registration.setMembers(1);
			},
			change: function( event, ui ) {
				//console.log("CHANGE"+JSON.stringify(ui, null, 2));
			}
			
		});
	}
	
	if($( '#country' )){
		$( '#country' ).on( 'focus', function() {
			if('' == $( '#country' ).val()){
				console.log('make dropdown');
				$( '#country' ).val(' ');
				$( '#country_iso' ).val(' ');
				$( '#country' ).hide();
				var country = '';
				var htmlTemplate = $('[template="country_select"]').clone(true);
				var renderedHTML = CurveStomp.templater.renderHTML('country', {}, htmlTemplate);
				
				$('#country_container').append(renderedHTML);
				htmlTemplate.removeAttr('template');
				
				var country_select = $('#country_container').find('#country_select');
				
				$.each(countries, function( key, value ) {
					//console.log('key: '+key+' value: '+JSON.stringify(value, null, 2));
					$(country_select).append($("<option></option>").attr("value",value.id).text(value.text)); 
				});
				
			}
		});
	
	}

	if($( '#first_time' )){
		$( '#first_time' ).on( 'change', function() {
			if (true == $(this).prop('checked')) {
				$( '#identity' ).show();
				$( '#returning' ).hide();
			}else{
				$( '#returning' ).show();
				$( '#identity' ).hide();
			}
		});
	}

	if($( '#symptom_form' )){
		$('#symptom_form').on('click', '.slider', function(event, ui){
			console.log('SLIDER CALLED');
			console.log("event"+JSON.stringify(event, null, 2));
			console.log("ui"+JSON.stringify(ui, null, 2));
			$(this).next(':input').val(ui.value);
		});
	}
	
	if($( '#user_guid' )){
		$( '#user_guid' ).on( 'focus', function() {
			var user_guid = getCookie('user_guid');
			if('' != user_guid){
				console.log('user_guid: '+user_guid);
				$( '#user_guid' ).val(user_guid);
			}
		});
	}

	if($( '#household_guid' )){
		$( '#household_guid' ).on( 'focus', function() {
			console.log('create_hash CALLED');
			var household_guid = $( '#household_guid' ).val();
			if('' != household_guid){
				return;
			}
			var country	= $( '#country' ).val();
			var region = $( '#region' ).val();
			var city = $( '#city' ).val();
			var street = $( '#street' ).val();
			var postal_code = $( '#postal_code' ).val();
			var time_stamp = Date.now();
			var hash_string = country+region+city+street+postal_code+time_stamp;
			hash_string = CurveStomp.createHash('MD5',hash_string);
			$( '#household_guid' ).val(hash_string);
		});
	}
	
	
	if($( '#user_identity' )){
		$( '#user_identity' ).on( 'focus', function() {
			hash_string = CurveStomp.uuidv4();
			$( '#user_identity' ).val(hash_string);
		});
	}
	
	if($( '[name=region]' )){
		$( '[name=region]' ).on( 'change', function() {
			console.log('region touched');
			console.log('region'+$( '[name=region]' ).val());
			
		});

	}
	
	
	
	
	
		
/*
$.i18n().load( {
	'en' : 'assets/js/l10n/en.json'
} );
$( '#location' ).show();
$( '#identity' ).show();
$( '#returning' ).show();
household_guid
*/ 
</script>
	
	
	
	
	
	
	
</body>
</html>


